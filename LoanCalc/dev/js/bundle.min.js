// vars
const calculate = document.querySelector('#sendForm');
const clear = document.querySelector('#clearInputs');
const UIamountInput = document.querySelector('#amount');
const UIinterestInput = document.querySelector('#interest');
const UIyearInput = document.querySelector('#years');

const UXmontlyPayment = document.querySelector('#montly-payment');
const UXtotalPayment = document.querySelector('#total-payment');
const UXtotalInterst = document.querySelector('#total-interest');


const loader = document.querySelector('.loader');
const results = document.querySelector('.results');

// calculation event
calculate.addEventListener('click', calculateResult);

function calculateResult(e) {
	const principal = parseFloat(UIamountInput.value);
	const calcInterest = parseFloat(UIinterestInput.value) / 100 / 12;
	const calcPayment = parseFloat(UIyearInput.value) * 12;

	// Compute montly payment
	const x = Math.pow(1 + calcInterest, calcPayment);
	const montly = (principal * x * calcInterest) / (x - 1);

	if (isFinite(montly)) {
		UXmontlyPayment.value = montly.toFixed(2);
		UXtotalPayment.value = (montly * calcPayment).toFixed(2);
		UXtotalInterst.value = ((montly * calcPayment) - principal).toFixed(2);
		// show loader, hide result
		loader.style.display = 'flex';
		results.style.display = 'none';
		// hide loader, show result
		setTimeout(() => {
			loader.style.display = 'none';
			results.style.display = 'block';
		}, 1500)
	} else {
		showError('Check your numbers')
	}
	e.preventDefault();

}

// Show error
function showError(error) {
	// create div
	const div = document.createElement('div');
	// container
	const container = document.querySelector('.container');
	// h1
	const h1 = document.querySelector('h1');
	// add class
	div.className = 'warning';
	// create textNde & append
	div.appendChild(document.createTextNode(error));
	// isert error
	container.insertBefore(div, h1);
	// clear warning
	setTimeout(() => {
		document.querySelector('.warning').remove();
	}, 2000);
}

// clear inputs
clear.addEventListener('click', function (e) {
	UIamountInput.value = '';
	UIinterestInput.value = '';
	UIyearInput.value = '';
	e.preventDefault();
})